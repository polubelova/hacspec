from speclib import *
from kyber import crypto_kem_keypair, crypto_kem_enc, crypto_kem_dec
from sys import exit

def test(keypaircoins, coins, msgcoins, pk_expected, sk_expected, ct_expected, ss_expected, num):
    pk, sk = crypto_kem_keypair(keypaircoins, coins)
    ct, ss1 = crypto_kem_enc(pk, msgcoins)
    ss2 = crypto_kem_dec(ct, sk)

    if (ss1 == ss2 and pk == pk_expected and sk == sk_expected and ct == ct_expected and ss1 == ss_expected):
        print("Kyber Test "+str(num)+" successful!")
    else:
        print("Kyber Test failed!")
        print("Computed shared secret 1: " + str(ss1))
        print("Computed shared secret 2: " + str(ss2))
        print("Expected shared secret: " + str(ss_expected))
        exit(1)

def main(x: int) -> None:
    keypaircoins = bytes.from_hex('934d60b35624d740b30a7f227af2ae7c678e4e04e13c5f509eade2b79aea77e2')
    coins = bytes.from_hex('3e2a2ea6c9c476fc4937b013c993a793d6c0ab9960695ba838f649da539ca3d0')
    msgcoins = bytes.from_hex('bac5ba881dd35c59719670004692d675b83c98db6a0e55800bafeb7e70491bf4')
    pk_expected = bytes.from_hex('c9f9afe72e604b4d6b0340cb4350aa2bfad9c675e34ab4fb8c4aa9f35540a6b2f0aba80694ec91ef515587c3a72bb90a091d21dccba69cef9a2b65d9fd2d0e011455948499ae6f2eeccdeda3dcd357ff573c7bedbb9751d469b9b0b5f8ded1cf26ce963b549b52a20b9ea514603943412f8e6cc3eeb34268861eb117636871135063bb9977f5ed4dedaa35650f717ca0785ff78dae11a44450379cac65b1fdbc74c823d83de3bfb3084291dbfd85f4f2ac3687d03806b550f4ba6ad9179e921b4fca0a9b33eec6689d23b86a1b4c0e1c6622b2fc1da99735f2ddc94256411662dd3b2231c33cedca3f515863d3fb58561e3826a5f544d5af3ea436f98bc486a47d62df8c298f257c4fb3927245918376ddea4cc0794b6f5e15e572fd9d4860c458401d951992b804d555270ad76b7f6dd6caca367c8d262ea6c66535a1165caa1c488d22ba7c725f6a5c19f32ebc52f600730c96f49c839b513440a5c915e9dfa90401cf95dbe595e9b885fad7d0fc5abd501edcf06f3fa8733acde7252b6e5b51433112f51269ab17bd0f73d94d621c2bad41be822f1444bcc7efca9478d3c0452de7dc86567d304985c1123ca097d2d07f65d863e664c62480081717f5fc04079c02561c75a902978c55209599a6c4b9d71be75e9b8dcd17629931d540f01478f25e12b52609988eb8123a6905380ccc74af9d690a5e3da5b014ae146ef9c225c13f392566d61e73751a49374c56884c788af869264ac1cc1c2db11770c751e8ffe1c7667397328894643716832a37b79d246e5440d4b1bfbc06e19b7ad4b90b593357756dc9f1d4a8807d8216d2c6f2a22a5eb7f28d7db249ada72f7d70c579d9a65d0431b61b8f63da5b83dc1fba81e2195e698dc7522506643f635b571dcfa5584e1e3b329e27db5964afbceaa569d51c615f38a6d5013f1b2b8f0fcf55476d7ff0b69cc1a52f181b52981d5eb163d2ad7253c029cc463a8a5b33963ab33be42e8a6bb83d3cea7b11308211efcf324032424fbb3dc8feb8e27c449d53c1366ff52cda0ba99a7529ad90c8e2e18b80bd13521b62ec1a0dfac61d8fcda2843eea86ea00b52c1697cb4fc1afde71ceafa07322486083514e335a9658a08da1b8002d2e46f456b4e32e82211167c250b398a1dbe6f8024b02315379363486ab70977776b898b84e87f8a44091ae02554106a515c836c6424e26cb0f20bdd2c58da14f6d16a7770784834d9b8d3a74877559f89962750985337be5f66e4deb73cce2db059e33684b4de2938697b9203092b5a0ee72b6e1cb15013aa7eba34b657df98f5f5e8eb8d7b47da59d86a2067bca9ab1055ac8ca3af8f654f881475fcf246885ad131f7eb9abb153f0c9d05194490bcc47c6d905eb67035eb7148d99b477b9df879018c68d3435de554962cc34401dbd6b13a8f2e33dc3c5f60b82d160a512458c00401256fbaacf50a929ae59e1cb61cdacb9ef681543b751f99306fab72f9bc85c0a13b9d041586fd583feb12afd5a402dd33b43543f5fa4eb436c8d')
    sk_expected = bytes.from_hex('b78e1727bd86310a6cf095c66b2febec495099a426e93893cb665c09d35272e126b0e8505aba1ad1c12faa7296467594a1a2e9c09efd0c46577d59b19f2bbccbae99e3bc6061f289e0240e93fbdfb04d364aaade190476e7f4cd9e2f159c907280a34fb3bbdbdb3e668f1640951db9b95690e0acbfa8029bdb21a8e7523fda9c2bed931a4357ecdce214b3e4ad620d49536f87a47eca070797e9b1d2a001c5c4942ccb92f47a92968bafb79319900fc68ac6fba5f228ffef46b74d49e63464513979c25bb89ff170c6258f9bb51b5d528a2d31de844fb4abadf206e493be224cccc474b8030f043a6daeb214774d9d5bcd7bc1a22ac01192703f888dc61a9dcd21a7905f81f261a241832d3e0244e73d40601d2f2e66fd22536f1f28b88d9bdca14755f9ea336b65da790af5043aae254162f2626a40f047e0db78800a0c02ddc07ad3d621d1668642dd92cb6e92d15b9b12fe302f28e762996372c1c0469508fa2d7944de3130cbe42baa94dc164fe5e8235a7db3202cdf3e85075781c54ad438626e1ed6b132a54c0af39cfe014cbba7b2608713d90e3a175acc8b0bd88389075816785737cc3d49b7a5d3e0ccd8f04d3ba689524cad0b89c0f0a15d1b9433c8c4ef9e501f44b4e3a671422fb05b0b60d90a78eb6bf39e46499117435e9ee633c317e7be1c67629cf26f8f40e6d0d584fc3b63c1f5ae61378898e30ccfc422cc49d38280e66bbd4f13f230a1e240957e276bfddb208c8e069b43e163f4285cb518bab1e70e87020d2e5b3413394d73712302bd8876753eda3a6c270c8e9315d00c6819d020981a1900c4a0375549a978e6c824c67a96a74877b5cb61986fd469f91ffe0b966b70214c9b7483bb3814d2bb561b68493dcdf21cb061516889a35ab7da6ea3d34cdf3aedb94e60ee9e939695c2b8d23a71dc434c86a223d7db67245fba65030085ce48c84e1203a2b60b720d4a6a3662997d61be910dc19307731abd2e7cbc2b9c44b7ddeb77b51097e561dbafa51b36e04439b181f90bc710bb1b0dca96341ef5d312816628ce963a340b61a04609d8553ba9af744063371e6ae22f5d3b95795f9d18a68455215200386d8c4dda72ef382e28ce889ced0086741979817d40af5da5c2c22a06f10d4106fec4c58c570f4fed607a38fd775b191b3fe40a81639b5bdfedeb439a7c1a06fd826e0744db45ab70424100b702b19ecbd03b58d89b13b609280e18afc8833e6bd5fc78ad84b2dd2cc811a21618c9a0f47f6d1ad5ce1e1eb84be268a6ecdd03bd1c311cf22369912671d4b0cc1d755662138090ec82803c147f51a995835f0e4873356eefac3b1755b8e4f020a95c9b53442595f856d3148f05b00a53a739e3ea963760ea21ec86fc9ccd6b50261b26df0d605589c3de04cf762742b9b4e8a42b6d22b0d12a71421b3dc0ba7a882bd688bd5dbc11b272cec088b69d3b5982431d5b18890b3ac478ba05d5d2aaac3c3b2d9610bb0d40e05070425810e6941a66964bbbf5a63cf826fa39b3f05a9cb3a33af35521a4117624bb38067bbd6430bf1156f9061d16d0e45e112a63f2e64055364dcbd897faa68ad19ff0420635aaa71285db9d7c1472cd2e5a7a5a87436d6cb1c3d50b4f00dc7860e09d7328a571f753829916e64cb925f55bd234adb5dd0f386169d150817c21a51160e1976d4393e6aa7c1e4818579bc871ef2d05dd620f8eb3e5531f2c272d923e1498da7794801427c3e867c83a50840bce7c5e5a0ef01cc9f9afe72e604b4d6b0340cb4350aa2bfad9c675e34ab4fb8c4aa9f35540a6b2f0aba80694ec91ef515587c3a72bb90a091d21dccba69cef9a2b65d9fd2d0e011455948499ae6f2eeccdeda3dcd357ff573c7bedbb9751d469b9b0b5f8ded1cf26ce963b549b52a20b9ea514603943412f8e6cc3eeb34268861eb117636871135063bb9977f5ed4dedaa35650f717ca0785ff78dae11a44450379cac65b1fdbc74c823d83de3bfb3084291dbfd85f4f2ac3687d03806b550f4ba6ad9179e921b4fca0a9b33eec6689d23b86a1b4c0e1c6622b2fc1da99735f2ddc94256411662dd3b2231c33cedca3f515863d3fb58561e3826a5f544d5af3ea436f98bc486a47d62df8c298f257c4fb3927245918376ddea4cc0794b6f5e15e572fd9d4860c458401d951992b804d555270ad76b7f6dd6caca367c8d262ea6c66535a1165caa1c488d22ba7c725f6a5c19f32ebc52f600730c96f49c839b513440a5c915e9dfa90401cf95dbe595e9b885fad7d0fc5abd501edcf06f3fa8733acde7252b6e5b51433112f51269ab17bd0f73d94d621c2bad41be822f1444bcc7efca9478d3c0452de7dc86567d304985c1123ca097d2d07f65d863e664c62480081717f5fc04079c02561c75a902978c55209599a6c4b9d71be75e9b8dcd17629931d540f01478f25e12b52609988eb8123a6905380ccc74af9d690a5e3da5b014ae146ef9c225c13f392566d61e73751a49374c56884c788af869264ac1cc1c2db11770c751e8ffe1c7667397328894643716832a37b79d246e5440d4b1bfbc06e19b7ad4b90b593357756dc9f1d4a8807d8216d2c6f2a22a5eb7f28d7db249ada72f7d70c579d9a65d0431b61b8f63da5b83dc1fba81e2195e698dc7522506643f635b571dcfa5584e1e3b329e27db5964afbceaa569d51c615f38a6d5013f1b2b8f0fcf55476d7ff0b69cc1a52f181b52981d5eb163d2ad7253c029cc463a8a5b33963ab33be42e8a6bb83d3cea7b11308211efcf324032424fbb3dc8feb8e27c449d53c1366ff52cda0ba99a7529ad90c8e2e18b80bd13521b62ec1a0dfac61d8fcda2843eea86ea00b52c1697cb4fc1afde71ceafa07322486083514e335a9658a08da1b8002d2e46f456b4e32e82211167c250b398a1dbe6f8024b02315379363486ab70977776b898b84e87f8a44091ae02554106a515c836c6424e26cb0f20bdd2c58da14f6d16a7770784834d9b8d3a74877559f89962750985337be5f66e4deb73cce2db059e33684b4de2938697b9203092b5a0ee72b6e1cb15013aa7eba34b657df98f5f5e8eb8d7b47da59d86a2067bca9ab1055ac8ca3af8f654f881475fcf246885ad131f7eb9abb153f0c9d05194490bcc47c6d905eb67035eb7148d99b477b9df879018c68d3435de554962cc34401dbd6b13a8f2e33dc3c5f60b82d160a512458c00401256fbaacf50a929ae59e1cb61cdacb9ef681543b751f99306fab72f9bc85c0a13b9d041586fd583feb12afd5a402dd33b43543f5fa4eb436c8d86be97871b745b34e2dfd72ec27a97e03be0f265aaa2724f84d9d1999ba5a92c3e2a2ea6c9c476fc4937b013c993a793d6c0ab9960695ba838f649da539ca3d0')
    ct_expected = bytes.from_hex('0741a7f88dcacce1de855238f4493aa5d693db59a17443c05f58770cc7b9e1309f69382dd61b5af193aee36ed8598ffe963576be93d5083b1afc6012cf37fb6f42e6f444c5be06f6db66c2095cab54140f7758b2f33cca91de4cc28c6da4ccd36587a503ee1b90462470d4b1abf017e465d0b247503e0f2731dd10d4d65faa85e98b513014963504b36ea50dc06b865416db8b77827922225ca26a80e4329b765c725191d247c4d94e52a1ec619f14b18a0514fb1bec02b5353b5f8246578489b616eb8be75b38edf5e2e05ae194ee571b689f31564183bac2d385f416534ee93b70306ced7532d54611c96ff6a6fe6f68305933a14dff753b316030f426b5390d3f726e117cadc44fc12e6f2bfb1b8578a9e36724ed6a23b96271b924fad406035de6a020d4ce08602e7086832522ec748d3cdc9403e89c085ba10be451cc1f2a34828ccc2a558c5f02b340bcb4a6cfc92db4644d01e948f164444a669bc179c122bd6771a7ddcb17ab271e7fa0fcbc5f337544f791fda5f13dc36ae564331e5be78870114c0c7a007ef17c5d7f6a8dd7a99ae171bbaaaf4c331a87cde7913a5fdee4bc6b09f3a19e75ea011caf29bcd4ed1fb38e720a2c7a0d66a3bb63a9f9855d996cf867477311228dc61ab1daf808d4daa1ea9f27ae1fa2a3af532fc90000a0f707033d943b9110daf2be5f62516ecafd358ca4786f48a9ea245d16310ec9617055577552647785f2bbb8563ed838bd696c8f0f9432a558bdda6e3991445d2b5c0f19f4f7314f31333a0b8c94781307c7d06a0ea967ead28c37f45bb7a86308d9b9c517a670f23b4caac60b58cecbf8b4e0ea23440a52f09f0197be2a4df96eec07a67dba0d68723253659cabf4361949d1734d182c2d7c72bb9f647b5c36200522770275f00f9976b42b86a77dbadabf392fd0407a56fb4da158086c0479239f8fecf70eee42137340b3186809e97a8615dd1cd85addd14053d127a1149238068ba7aebd43d849fde8e0e95d02ee9cbda678ce24cad0da8a942bdbfb565462c6de7d426472dd7ef2649b44fbfd113b78d3e75bac946ec6efa509eda549a90f7846c990900a29874c03e0d84116c2fbf0b5b9eb936afb9c54c6f0ac66a5c32e1efbbc1b56e02485d9333013f490a4120ecf976dd0c1b7c0dfe9b7f700bd6822faedd32aa75e465ec92d0512ed15001e153e53e510f237ac3436af1667b6c4520b40146fada99ca8e27a42315faabe14ae1e703894694a4ec8d7655f7baed5ed314a07a8f2adc4be1ab573abbb613ab740d546e9c5e04ecf2c7c5ac649bdbe7041eb0e3f508afb02cb9e923ca0f843a4df30fd7957e5f13966542d17e0c6101b25f21f2b2374237c3368303c7539c89ccc798f372d95ba41bde6f403abb85ef9436a6afce02f0ac74074e9356fade7c99c60a2b418a5eb6296607e124edb52694a85a0c13092d9cea9025b2736b4f5da97156ee5d6e8385957f221b39cd3baa6066bd4856e8ec8da7791314a73d802282d3c95d6e37ef358c42de500b8f138054dc86d0799c527f19ec9bb5de4721b025b2217f1047462cc1437fbacc909852ac754bc8e91d4e569a69807f82c18756ecb39be6e7d0e00544b14bff24da4')
    ss_expected = bytes.from_hex('23c7a3ae29223b8114db02fa5cf8834b11e48fc55e69534b032a695516cd93ee')
    test(keypaircoins, coins, msgcoins, pk_expected, sk_expected, ct_expected, ss_expected, 0)

if __name__ == "__main__":
    main(0)
